model Hyperparameter {
  id            String    @id @default(uuid())
  name          String    @unique
  displayName   String    @map("display_name")
  parameterType String    @map("parameter_type")
  description   String?
  isActive      Boolean   @default(true) @map("is_active")
  createdAt     DateTime  @default(now()) @map("created_at")
  createdBy     String?   @map("created_by")
  updatedAt     DateTime? @updatedAt @map("updated_at")
  updatedBy     String?   @map("updated_by")

  createdByUser User?                     @relation("HyperparameterCreatedBy", fields: [createdBy], references: [id])
  updatedByUser User?                     @relation("HyperparameterUpdatedBy", fields: [updatedBy], references: [id])
  modelLinks    ModelHyperparameterLink[]

  @@index([name])
  @@index([isActive])
  @@map("hyperparameters")
}

model ModelHyperparameterLink {
  id               String    @id @default(uuid())
  modelVersionId   String    @map("model_version_id")
  hyperparameterId String    @map("hyperparameter_id")
  isConfigurable   Boolean   @default(true) @map("is_configurable")
  isRequired       Boolean   @default(false) @map("is_required")
  lockedValue      Json?     @map("locked_value")
  lockedAt         DateTime? @map("locked_at")
  lockedReason     String?   @map("locked_reason")
  minValue         Decimal?  @map("min_value")
  maxValue         Decimal?  @map("max_value")
  stepValue        Decimal?  @map("step_value")
  allowedValues    Json?     @map("allowed_values")
  defaultValue     Json?     @map("default_value")
  uiComponent      String?   @map("ui_component")
  uiOrder          Int       @default(0) @map("ui_order")
  helpText         String?   @map("help_text")
  createdAt        DateTime  @default(now()) @map("created_at")
  createdBy        String?   @map("created_by")
  updatedAt        DateTime? @updatedAt @map("updated_at")
  updatedBy        String?   @map("updated_by")

  modelVersion   ModelVersion   @relation(fields: [modelVersionId], references: [id])
  hyperparameter Hyperparameter @relation(fields: [hyperparameterId], references: [id])
  createdByUser  User?          @relation("ModelHyperparameterLinkCreatedBy", fields: [createdBy], references: [id])
  updatedByUser  User?          @relation("ModelHyperparameterLinkUpdatedBy", fields: [updatedBy], references: [id])

  @@unique([modelVersionId, hyperparameterId])
  @@index([modelVersionId])
  @@index([hyperparameterId])
  @@index([isConfigurable])
  @@map("model_hyperparameter_links")
}
