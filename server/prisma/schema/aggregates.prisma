model ExpertConsensus {
    id                String   @id @default(uuid())
    questionId        String   @unique @map("question_id")
    expertMean        Float    @map("expert_mean")
    expertStd         Float?   @map("expert_std")
    expertCount       Int      @map("expert_count")
    individualRatings Json?    @map("individual_ratings")
    firstRating       DateTime @map("first_rating")
    lastRating        DateTime @map("last_rating")
    lastRefreshed     DateTime @default(now()) @map("last_refreshed")

    question BenchmarkQuestion @relation(fields: [questionId], references: [id])

    @@index([expertCount])
    @@index([lastRefreshed])
    @@map("expert_consensus")
}

model BenchmarkScoreAggregate {
    id                   String   @id @default(uuid())
    modelVersionId       String   @map("model_version_id")
    scaleId              String   @map("scale_id")
    hyperparameterHash   String?  @map("hyperparameter_hash")
    hyperparameterConfig Json?    @map("hyperparameter_config")
    systemPromptId       String?  @map("system_prompt_id")
    messagePromptId      String?  @map("message_prompt_id")
    runCount             Int      @map("run_count")
    modelMean            Float    @map("model_mean")
    modelStd             Float?   @map("model_std")
    modelMin             Float?   @map("model_min")
    modelMax             Float?   @map("model_max")
    modelMedian          Float?   @map("model_median")
    expertConsensusMean  Float?   @map("expert_consensus_mean")
    rmseVsExperts        Float?   @map("rmse_vs_experts")
    firstRun             DateTime @map("first_run")
    lastRun              DateTime @map("last_run")
    experimentCount      Int      @map("experiment_count")
    lastRefreshed        DateTime @default(now()) @map("last_refreshed")

    modelVersion  ModelVersion     @relation(fields: [modelVersionId], references: [id])
    scale         BenchmarkScale   @relation(fields: [scaleId], references: [id])
    systemPrompt  BenchmarkPrompt? @relation("AggregateSystemPrompt", fields: [systemPromptId], references: [id])
    messagePrompt BenchmarkPrompt? @relation("AggregateMessagePrompt", fields: [messagePromptId], references: [id])

    @@unique([modelVersionId, scaleId, hyperparameterHash, systemPromptId, messagePromptId])
    @@index([scaleId, rmseVsExperts])
    @@index([runCount])
    @@index([lastRefreshed])
    @@map("benchmark_score_aggregates")
}
